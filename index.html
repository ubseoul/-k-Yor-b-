<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>√àk√≥ Yor√πb√° ‚Äî Learn Yoruba</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&family=Fraunces:opsz,wght@9..144,300;9..144,500;9..144,700&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #FAFAF8;
  --surface: #FFFFFF;
  --surface-2: #F5F4F0;
  --border: #E8E6E1;
  --text: #1A1A18;
  --text-2: #6B6963;
  --text-3: #9C9890;
  --accent: #2D6A4F;
  --accent-light: #D8F3DC;
  --accent-dark: #1B4332;
  --warm: #D4A373;
  --warm-light: #FEFAE0;
  --error: #BC4749;
  --error-light: #FDE8E8;
  --success: #2D6A4F;
  --success-light: #D8F3DC;
  --radius: 16px;
  --radius-sm: 10px;
  --shadow: 0 1px 3px rgba(0,0,0,0.04), 0 4px 12px rgba(0,0,0,0.03);
  --shadow-lg: 0 4px 24px rgba(0,0,0,0.06);
}

* { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
  font-family: 'DM Sans', sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100dvh;
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
}

.app {
  max-width: 480px;
  margin: 0 auto;
  min-height: 100dvh;
  position: relative;
}

/* ‚îÄ‚îÄ‚îÄ Header ‚îÄ‚îÄ‚îÄ */
.header {
  padding: 16px 20px 12px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: sticky;
  top: 0;
  background: var(--bg);
  z-index: 100;
  border-bottom: 1px solid var(--border);
}

.header-back {
  width: 40px; height: 40px;
  border: none; background: var(--surface-2);
  border-radius: 12px; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: all 0.2s;
}
.header-back:hover { background: var(--border); }
.header-back svg { width: 20px; height: 20px; color: var(--text); }

.header-title {
  font-family: 'Fraunces', serif;
  font-size: 18px;
  font-weight: 500;
  letter-spacing: -0.3px;
}

.header-streak {
  display: flex; align-items: center; gap: 6px;
  font-size: 14px; font-weight: 600;
  color: var(--warm);
  background: var(--warm-light);
  padding: 6px 12px;
  border-radius: 20px;
}

/* ‚îÄ‚îÄ‚îÄ Home Screen ‚îÄ‚îÄ‚îÄ */
.home { padding: 20px; padding-bottom: 100px; }

.home-hero {
  text-align: center;
  padding: 40px 20px 32px;
}

.home-hero h1 {
  font-family: 'Fraunces', serif;
  font-size: 36px;
  font-weight: 700;
  letter-spacing: -1px;
  line-height: 1.1;
  margin-bottom: 8px;
}

.home-hero p {
  color: var(--text-2);
  font-size: 16px;
  line-height: 1.5;
}

.progress-overview {
  background: var(--surface);
  border-radius: var(--radius);
  padding: 20px;
  margin-bottom: 28px;
  box-shadow: var(--shadow);
  border: 1px solid var(--border);
}

.progress-bar-container {
  display: flex; align-items: center; gap: 12px;
  margin-bottom: 8px;
}

.progress-bar {
  flex: 1; height: 8px;
  background: var(--surface-2);
  border-radius: 4px;
  overflow: hidden;
}

.progress-bar-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--accent), #52B788);
  border-radius: 4px;
  transition: width 0.6s ease;
}

.progress-label {
  font-size: 13px;
  color: var(--text-2);
}

.progress-stats {
  display: flex; gap: 16px; margin-top: 14px;
}

.progress-stat {
  flex: 1;
  text-align: center;
  padding: 10px;
  background: var(--surface-2);
  border-radius: var(--radius-sm);
}

.progress-stat-num {
  font-size: 22px;
  font-weight: 700;
  color: var(--accent);
  font-family: 'Fraunces', serif;
}

.progress-stat-label {
  font-size: 11px;
  color: var(--text-3);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-top: 2px;
}

.section-title {
  font-family: 'Fraunces', serif;
  font-size: 20px;
  font-weight: 600;
  margin-bottom: 16px;
  letter-spacing: -0.3px;
}

.unit-card {
  background: var(--surface);
  border-radius: var(--radius);
  padding: 20px;
  margin-bottom: 12px;
  box-shadow: var(--shadow);
  border: 1px solid var(--border);
  cursor: pointer;
  transition: all 0.2s;
  position: relative;
  overflow: hidden;
}

.unit-card:hover { transform: translateY(-1px); box-shadow: var(--shadow-lg); }
.unit-card.locked { opacity: 0.5; pointer-events: none; }

.unit-card-header {
  display: flex; align-items: flex-start; justify-content: space-between;
  margin-bottom: 10px;
}

.unit-num {
  font-size: 12px;
  font-weight: 600;
  color: var(--accent);
  background: var(--accent-light);
  padding: 4px 10px;
  border-radius: 20px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.unit-card h3 {
  font-family: 'Fraunces', serif;
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 4px;
  letter-spacing: -0.2px;
}

.unit-card p {
  font-size: 14px;
  color: var(--text-2);
  line-height: 1.4;
}

.unit-lessons {
  display: flex; gap: 4px; margin-top: 12px;
}

.unit-lesson-dot {
  width: 8px; height: 8px;
  border-radius: 50%;
  background: var(--border);
}
.unit-lesson-dot.done { background: var(--accent); }
.unit-lesson-dot.current { background: var(--warm); }

.unit-emoji {
  font-size: 28px;
  margin-top: -2px;
}

/* ‚îÄ‚îÄ‚îÄ Unit View ‚îÄ‚îÄ‚îÄ */
.unit-view { padding: 20px; padding-bottom: 100px; }

.unit-view-header {
  text-align: center;
  padding: 20px 0 28px;
}

.unit-view-header h2 {
  font-family: 'Fraunces', serif;
  font-size: 26px;
  font-weight: 700;
  letter-spacing: -0.5px;
  margin-bottom: 4px;
}

.unit-view-header p {
  color: var(--text-2);
  font-size: 15px;
}

.lesson-card {
  background: var(--surface);
  border-radius: var(--radius);
  padding: 18px 20px;
  margin-bottom: 10px;
  box-shadow: var(--shadow);
  border: 1px solid var(--border);
  display: flex;
  align-items: center;
  gap: 16px;
  cursor: pointer;
  transition: all 0.2s;
}

.lesson-card:hover { transform: translateY(-1px); box-shadow: var(--shadow-lg); }
.lesson-card.locked { opacity: 0.45; pointer-events: none; }

.lesson-icon {
  width: 48px; height: 48px;
  border-radius: 14px;
  display: flex; align-items: center; justify-content: center;
  font-size: 13px; font-weight: 600;
  flex-shrink: 0;
}

.lesson-icon.vocab { background: var(--accent-light); color: var(--accent-dark); }
.lesson-icon.flash { background: #FFF3CD; color: #856404; }
.lesson-icon.quiz { background: #D6E9FF; color: #1A4B8C; }
.lesson-icon.dialogue { background: #F3E5F5; color: #6A1B9A; }
.lesson-icon.culture { background: var(--warm-light); color: #8B6914; }
.lesson-icon.done { background: var(--success-light); color: var(--success); }

.lesson-info { flex: 1; }
.lesson-info h4 { font-size: 15px; font-weight: 600; margin-bottom: 2px; }
.lesson-info p { font-size: 13px; color: var(--text-3); }

.lesson-check {
  width: 24px; height: 24px;
  border-radius: 50%;
  border: 2px solid var(--border);
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
}
.lesson-check.done {
  background: var(--accent);
  border-color: var(--accent);
}
.lesson-check.done svg { display: block; }

/* ‚îÄ‚îÄ‚îÄ Vocabulary Lesson ‚îÄ‚îÄ‚îÄ */
.vocab-view { padding: 20px; padding-bottom: 100px; }

.vocab-card {
  background: var(--surface);
  border-radius: var(--radius);
  padding: 32px 24px;
  text-align: center;
  box-shadow: var(--shadow-lg);
  border: 1px solid var(--border);
  margin-bottom: 16px;
  min-height: 240px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: relative;
}

.vocab-yoruba {
  font-family: 'Fraunces', serif;
  font-size: 36px;
  font-weight: 700;
  letter-spacing: -0.5px;
  margin-bottom: 6px;
  color: var(--accent-dark);
}

.vocab-phonetic {
  font-size: 16px;
  color: var(--text-3);
  font-style: italic;
  margin-bottom: 16px;
}

.vocab-english {
  font-size: 20px;
  font-weight: 500;
  margin-bottom: 6px;
}

.vocab-context {
  font-size: 14px;
  color: var(--text-2);
  line-height: 1.5;
  max-width: 300px;
}

.tone-display {
  display: flex;
  align-items: flex-end;
  justify-content: center;
  gap: 6px;
  margin: 16px 0;
  height: 50px;
}

.tone-syllable {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
}

.tone-bar {
  width: 32px;
  border-radius: 4px;
  transition: height 0.3s;
}

.tone-bar.high { height: 44px; background: var(--accent); }
.tone-bar.mid { height: 28px; background: var(--warm); }
.tone-bar.low { height: 16px; background: var(--error); }

.tone-label {
  font-size: 11px;
  color: var(--text-3);
  font-weight: 500;
}

.speak-btn {
  width: 52px; height: 52px;
  border-radius: 50%;
  background: var(--accent);
  color: white;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 12px auto;
  transition: all 0.2s;
  box-shadow: 0 2px 8px rgba(45,106,79,0.3);
}

.speak-btn:hover { transform: scale(1.08); }
.speak-btn:active { transform: scale(0.95); }
.speak-btn svg { width: 24px; height: 24px; }

.vocab-nav {
  display: flex;
  gap: 12px;
  justify-content: center;
  margin-top: 8px;
}

.vocab-nav-btn {
  padding: 14px 32px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--border);
  background: var(--surface);
  font-size: 15px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  font-family: 'DM Sans', sans-serif;
}

.vocab-nav-btn:hover { background: var(--surface-2); }

.vocab-nav-btn.primary {
  background: var(--accent);
  color: white;
  border-color: var(--accent);
}
.vocab-nav-btn.primary:hover { background: var(--accent-dark); }

.vocab-counter {
  text-align: center;
  font-size: 13px;
  color: var(--text-3);
  margin-bottom: 16px;
}

/* ‚îÄ‚îÄ‚îÄ Flashcard Mode ‚îÄ‚îÄ‚îÄ */
.flashcard-area {
  perspective: 1000px;
  margin-bottom: 20px;
}

.flashcard {
  background: var(--surface);
  border-radius: var(--radius);
  min-height: 280px;
  box-shadow: var(--shadow-lg);
  border: 1px solid var(--border);
  cursor: pointer;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 32px 24px;
  text-align: center;
  transition: transform 0.5s;
  transform-style: preserve-3d;
  position: relative;
}

.flashcard.flipped { transform: rotateY(180deg); }

.flashcard-front, .flashcard-back {
  backface-visibility: hidden;
  position: absolute;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%;
  padding: 24px;
}

.flashcard-back { transform: rotateY(180deg); }

.flashcard-tap {
  font-size: 13px;
  color: var(--text-3);
  margin-top: 12px;
}

.flashcard-btns {
  display: flex;
  gap: 10px;
}

.flash-btn {
  flex: 1;
  padding: 16px;
  border-radius: var(--radius-sm);
  border: none;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  font-family: 'DM Sans', sans-serif;
}

.flash-btn.again {
  background: var(--error-light);
  color: var(--error);
}
.flash-btn.hard {
  background: #FFF3CD;
  color: #856404;
}
.flash-btn.good {
  background: var(--success-light);
  color: var(--success);
}

/* ‚îÄ‚îÄ‚îÄ Quiz Mode ‚îÄ‚îÄ‚îÄ */
.quiz-view { padding: 20px; padding-bottom: 100px; }

.quiz-progress {
  display: flex;
  gap: 4px;
  margin-bottom: 24px;
}

.quiz-dot {
  flex: 1;
  height: 4px;
  border-radius: 2px;
  background: var(--border);
  transition: background 0.3s;
}
.quiz-dot.correct { background: var(--accent); }
.quiz-dot.wrong { background: var(--error); }
.quiz-dot.current { background: var(--warm); }

.quiz-question {
  background: var(--surface);
  border-radius: var(--radius);
  padding: 28px 24px;
  text-align: center;
  box-shadow: var(--shadow);
  border: 1px solid var(--border);
  margin-bottom: 20px;
}

.quiz-question-label {
  font-size: 13px;
  color: var(--text-3);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 12px;
}

.quiz-question-text {
  font-family: 'Fraunces', serif;
  font-size: 28px;
  font-weight: 600;
  letter-spacing: -0.3px;
}

.quiz-options {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.quiz-option {
  padding: 18px 20px;
  border-radius: var(--radius-sm);
  border: 2px solid var(--border);
  background: var(--surface);
  font-size: 16px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  text-align: left;
  font-family: 'DM Sans', sans-serif;
}

.quiz-option:hover { border-color: var(--accent); background: var(--accent-light); }
.quiz-option.selected { border-color: var(--accent); background: var(--accent-light); }
.quiz-option.correct { border-color: var(--success); background: var(--success-light); }
.quiz-option.wrong { border-color: var(--error); background: var(--error-light); }
.quiz-option.disabled { pointer-events: none; }

.quiz-feedback {
  text-align: center;
  padding: 20px;
  margin-top: 16px;
  border-radius: var(--radius-sm);
  font-size: 15px;
  font-weight: 500;
  animation: fadeUp 0.3s ease;
}

.quiz-feedback.correct { background: var(--success-light); color: var(--success); }
.quiz-feedback.wrong { background: var(--error-light); color: var(--error); }

.quiz-next {
  width: 100%;
  padding: 16px;
  border-radius: var(--radius-sm);
  background: var(--accent);
  color: white;
  border: none;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  margin-top: 16px;
  font-family: 'DM Sans', sans-serif;
  transition: all 0.2s;
}

.quiz-next:hover { background: var(--accent-dark); }

/* ‚îÄ‚îÄ‚îÄ Dialogue Mode ‚îÄ‚îÄ‚îÄ */
.dialogue-view { padding: 20px; padding-bottom: 100px; }

.dialogue-scene {
  background: var(--surface);
  border-radius: var(--radius);
  padding: 20px;
  margin-bottom: 20px;
  border: 1px solid var(--border);
  box-shadow: var(--shadow);
}

.dialogue-scene-label {
  font-size: 12px; color: var(--text-3);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 6px;
}

.dialogue-scene p {
  font-size: 15px;
  color: var(--text-2);
  line-height: 1.5;
  font-style: italic;
}

.dialogue-messages {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-bottom: 20px;
}

.dialogue-msg {
  max-width: 85%;
  padding: 14px 18px;
  border-radius: 18px;
  font-size: 15px;
  line-height: 1.5;
  animation: fadeUp 0.3s ease;
}

.dialogue-msg.grandma {
  align-self: flex-start;
  background: var(--surface);
  border: 1px solid var(--border);
  border-bottom-left-radius: 6px;
}

.dialogue-msg.you {
  align-self: flex-end;
  background: var(--accent);
  color: white;
  border-bottom-right-radius: 6px;
}

.dialogue-msg .msg-speaker {
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 4px;
  opacity: 0.7;
}

.dialogue-msg .msg-translation {
  font-size: 12px;
  margin-top: 6px;
  opacity: 0.7;
  font-style: italic;
}

.dialogue-choices {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.dialogue-choices label {
  font-size: 13px;
  color: var(--text-3);
  margin-bottom: 4px;
}

.dialogue-choice {
  padding: 16px 18px;
  border-radius: var(--radius-sm);
  border: 2px solid var(--border);
  background: var(--surface);
  cursor: pointer;
  transition: all 0.2s;
  font-family: 'DM Sans', sans-serif;
  font-size: 15px;
}

.dialogue-choice:hover { border-color: var(--accent); }
.dialogue-choice.correct { border-color: var(--success); background: var(--success-light); }
.dialogue-choice.wrong { border-color: var(--error); background: var(--error-light); }

.dialogue-choice .choice-yoruba { font-weight: 600; margin-bottom: 2px; }
.dialogue-choice .choice-english { font-size: 13px; color: var(--text-2); }

/* ‚îÄ‚îÄ‚îÄ Culture Note ‚îÄ‚îÄ‚îÄ */
.culture-view { padding: 20px; padding-bottom: 100px; }

.culture-card {
  background: var(--surface);
  border-radius: var(--radius);
  padding: 28px 24px;
  box-shadow: var(--shadow);
  border: 1px solid var(--border);
  margin-bottom: 16px;
}

.culture-card h3 {
  font-family: 'Fraunces', serif;
  font-size: 22px;
  font-weight: 600;
  margin-bottom: 12px;
}

.culture-card p {
  font-size: 15px;
  color: var(--text-2);
  line-height: 1.7;
  margin-bottom: 12px;
}

.culture-highlight {
  background: var(--warm-light);
  border-left: 3px solid var(--warm);
  padding: 16px;
  border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
  margin: 16px 0;
}

.culture-highlight p {
  margin: 0;
  font-size: 14px;
  color: var(--text);
}

/* ‚îÄ‚îÄ‚îÄ Completion Screen ‚îÄ‚îÄ‚îÄ */
.complete-screen {
  text-align: center;
  padding: 60px 20px;
}

.complete-emoji { font-size: 64px; margin-bottom: 20px; }

.complete-screen h2 {
  font-family: 'Fraunces', serif;
  font-size: 28px;
  font-weight: 700;
  margin-bottom: 8px;
}

.complete-screen p {
  color: var(--text-2);
  font-size: 16px;
  margin-bottom: 24px;
}

.complete-stats {
  display: flex;
  gap: 16px;
  justify-content: center;
  margin-bottom: 32px;
}

.complete-stat {
  text-align: center;
}

.complete-stat-num {
  font-size: 28px;
  font-weight: 700;
  color: var(--accent);
  font-family: 'Fraunces', serif;
}

.complete-stat-label {
  font-size: 12px;
  color: var(--text-3);
}

/* ‚îÄ‚îÄ‚îÄ Animations ‚îÄ‚îÄ‚îÄ */
@keyframes fadeUp {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.fade-in { animation: fadeUp 0.4s ease; }

/* ‚îÄ‚îÄ‚îÄ Tone Legend ‚îÄ‚îÄ‚îÄ */
.tone-legend {
  display: flex;
  gap: 16px;
  justify-content: center;
  margin: 12px 0;
  font-size: 12px;
  color: var(--text-3);
}

.tone-legend-item {
  display: flex;
  align-items: center;
  gap: 4px;
}

.tone-legend-dot {
  width: 10px; height: 10px;
  border-radius: 3px;
}

.tone-legend-dot.high { background: var(--accent); }
.tone-legend-dot.mid { background: var(--warm); }
.tone-legend-dot.low { background: var(--error); }

/* ‚îÄ‚îÄ‚îÄ Scrollbar ‚îÄ‚îÄ‚îÄ */
::-webkit-scrollbar { width: 0; }

/* ‚îÄ‚îÄ‚îÄ Review All button ‚îÄ‚îÄ‚îÄ */
.review-btn {
  width: 100%;
  padding: 16px;
  border-radius: var(--radius-sm);
  background: var(--surface);
  border: 2px dashed var(--border);
  font-size: 15px;
  font-weight: 500;
  color: var(--text-2);
  cursor: pointer;
  font-family: 'DM Sans', sans-serif;
  transition: all 0.2s;
  margin-top: 16px;
}

.review-btn:hover { border-color: var(--accent); color: var(--accent); }
</style>
</head>
<body>

<div class="app" id="app"></div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// COMPLETE YORUBA CURRICULUM DATA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const CURRICULUM = [
  // ‚îÄ‚îÄ‚îÄ UNIT 1: GREETINGS & RESPECT ‚îÄ‚îÄ‚îÄ
  {
    id: 'greetings',
    title: 'Greetings & Respect',
    subtitle: 'The foundation of every conversation',
    emoji: 'üôè',
    vocab: [
      { yoruba: '·∫∏ k√∫ √†√°r·ªçÃÄ', english: 'Good morning', phonetic: 'eh koo AH-ro', tones: [{s:'·∫∏',t:'mid'},{s:'k√∫',t:'high'},{s:'√†√°',t:'low'},{s:'r·ªçÃÄ',t:'low'}], context: 'Used when greeting elders in the morning. The "·∫∏" makes it respectful.' },
      { yoruba: '·∫∏ k√∫ ·ªçÃÄs√°n', english: 'Good afternoon', phonetic: 'eh koo OH-san', tones: [{s:'·∫∏',t:'mid'},{s:'k√∫',t:'high'},{s:'·ªçÃÄ',t:'low'},{s:'s√°n',t:'high'}], context: 'Afternoon greeting for elders. Shows respect with the "·∫∏" prefix.' },
      { yoruba: '·∫∏ k√∫ ir·ªçÃÅl·∫πÃÅ', english: 'Good evening', phonetic: 'eh koo ee-RO-leh', tones: [{s:'·∫∏',t:'mid'},{s:'k√∫',t:'high'},{s:'i',t:'mid'},{s:'r·ªçÃÅ',t:'high'},{s:'l·∫πÃÅ',t:'high'}], context: 'Evening greeting for elders. Use this when you visit grandma in the evening.' },
      { yoruba: '·∫∏ k√∫ al·∫πÃÅ', english: 'Good night', phonetic: 'eh koo ah-LEH', tones: [{s:'·∫∏',t:'mid'},{s:'k√∫',t:'high'},{s:'a',t:'mid'},{s:'l·∫πÃÅ',t:'high'}], context: 'Night greeting or goodbye at night.' },
      { yoruba: '·∫∏ k√†√°s√°n', english: 'Good day', phonetic: 'eh KAH-san', tones: [{s:'·∫∏',t:'mid'},{s:'k√†',t:'low'},{s:'√°',t:'high'},{s:'s√°n',t:'high'}], context: 'A general daytime greeting you can use anytime.' },
      { yoruba: '√ì d√†b·ªçÃÄ', english: 'Goodbye', phonetic: 'oh DAH-boh', tones: [{s:'√ì',t:'high'},{s:'d√†',t:'low'},{s:'b·ªçÃÄ',t:'low'}], context: 'Said to the person leaving. Literally means "until we meet again."' },
      { yoruba: '·∫∏ ·π£√©', english: 'Thank you', phonetic: 'eh SHEH', tones: [{s:'·∫∏',t:'mid'},{s:'·π£√©',t:'high'}], context: 'Respectful thank you. Drop the "·∫∏" for casual use with peers: "√ì ·π£√©"' },
      { yoruba: '·∫∏ k√∫ il√©', english: 'Welcome home', phonetic: 'eh koo ee-LEH', tones: [{s:'·∫∏',t:'mid'},{s:'k√∫',t:'high'},{s:'i',t:'mid'},{s:'l√©',t:'high'}], context: 'Said to someone returning home. Grandma might say this when you visit!' },
      { yoruba: '·∫∏ k√∫ i·π£·∫πÃÅ', english: 'Well done / greetings for work', phonetic: 'eh koo ee-SHEH', tones: [{s:'·∫∏',t:'mid'},{s:'k√∫',t:'high'},{s:'i',t:'mid'},{s:'·π£·∫πÃÅ',t:'high'}], context: 'Said to acknowledge someone working or busy. Very common greeting.' },
      { yoruba: 'B√†w·ªçÃÅ ni', english: 'How are you?', phonetic: 'BAH-wo nee', tones: [{s:'B√†',t:'low'},{s:'w·ªçÃÅ',t:'high'},{s:'ni',t:'mid'}], context: 'Casual way to ask how someone is.' },
    ],
    dialogues: [
      {
        scene: 'You arrive at grandma\'s house in the morning.',
        steps: [
          { speaker: 'grandma', yoruba: '·∫∏ k√†√°s√°n, ·ªçm·ªç mi!', english: 'Good day, my child!' },
          {
            speaker: 'you', prompt: 'Greet grandma back:',
            choices: [
              { yoruba: '·∫∏ k√∫ √†√°r·ªçÃÄ, M√†m√°!', english: 'Good morning, Mama!', correct: true },
              { yoruba: '√ì d√†b·ªçÃÄ', english: 'Goodbye', correct: false },
              { yoruba: 'B√†w·ªçÃÅ ni', english: 'How are you?', correct: false },
            ]
          },
          { speaker: 'grandma', yoruba: '·π¢√© d√°ad√°a ni?', english: 'Is everything well?' },
          {
            speaker: 'you', prompt: 'Respond that you are fine:',
            choices: [
              { yoruba: '·∫∏ ·π£√©, M√†m√°', english: 'Thank you, Mama', correct: false },
              { yoruba: 'D√°ad√°a ni, M√†m√°. ·∫∏ ·π£√©', english: 'It is well, Mama. Thank you', correct: true },
              { yoruba: '√ì d√†b·ªçÃÄ, M√†m√°', english: 'Goodbye, Mama', correct: false },
            ]
          }
        ]
      }
    ],
    culture: {
      title: 'Why Greetings Matter So Much',
      paragraphs: [
        'In Yoruba culture, greetings are not just polite ‚Äî they are essential. Failing to greet an elder properly is considered deeply disrespectful. When you greet your grandma well, you are showing her that you value her, her age, and your relationship.',
        'Traditionally, young men prostrate (d·ªçÃÄb√°l·∫πÃÄ ‚Äî lying flat on the ground) and young women kneel (k√∫nl·∫πÃÄ) when greeting elders. Even if you don\'t do the full prostration, bowing your head or kneeling slightly shows deep respect.',
        'Yoruba has different greetings for different times of day, different situations (arriving, leaving, working, eating, waking up), and even for different events (celebrations, condolences). Learning these shows cultural awareness.',
      ],
      highlight: 'Tip: When you see grandma, greet her FIRST before saying anything else. Start with the time-appropriate greeting, then ask how she is. This alone will make her beam with pride.'
    }
  },

  // ‚îÄ‚îÄ‚îÄ UNIT 2: FAMILY & IDENTITY ‚îÄ‚îÄ‚îÄ
  {
    id: 'family',
    title: 'Family & Identity',
    subtitle: 'Know your people, introduce yourself',
    emoji: 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶',
    vocab: [
      { yoruba: '√åy√° mi', english: 'My mother', phonetic: 'EE-yah mee', tones: [{s:'√å',t:'low'},{s:'y√°',t:'high'},{s:'mi',t:'mid'}], context: 'How you refer to your mother. "Mi" means "my."' },
      { yoruba: 'B√†b√° mi', english: 'My father', phonetic: 'BAH-bah mee', tones: [{s:'B√†',t:'low'},{s:'b√°',t:'high'},{s:'mi',t:'mid'}], context: 'How you refer to your father.' },
      { yoruba: '√åy√° √†gb√†', english: 'Grandmother', phonetic: 'EE-yah AHG-bah', tones: [{s:'√å',t:'low'},{s:'y√°',t:'high'},{s:'√†g',t:'low'},{s:'b√†',t:'low'}], context: 'Literally "elder mother." This is grandma!' },
      { yoruba: 'B√†b√° √†gb√†', english: 'Grandfather', phonetic: 'BAH-bah AHG-bah', tones: [{s:'B√†',t:'low'},{s:'b√°',t:'high'},{s:'√†g',t:'low'},{s:'b√†',t:'low'}], context: 'Literally "elder father." This is grandpa.' },
      { yoruba: '·ªåm·ªç', english: 'Child', phonetic: 'OH-moh', tones: [{s:'·ªå',t:'mid'},{s:'m·ªç',t:'mid'}], context: 'Grandma might call you "·ªçm·ªç mi" ‚Äî my child.' },
      { yoruba: '·∫∏ÃÄgb·ªçÃÅn', english: 'Older sibling', phonetic: 'EHG-bon', tones: [{s:'·∫∏ÃÄg',t:'low'},{s:'b·ªçÃÅn',t:'high'}], context: 'Used for any older sibling, male or female.' },
      { yoruba: '√Äb√∫r√≤', english: 'Younger sibling', phonetic: 'AH-boo-roh', tones: [{s:'√Ä',t:'low'},{s:'b√∫',t:'high'},{s:'r√≤',t:'low'}], context: 'Used for any younger sibling.' },
      { yoruba: 'Or√∫k·ªç mi ni...', english: 'My name is...', phonetic: 'oh-ROO-koh mee nee', tones: [{s:'O',t:'mid'},{s:'r√∫',t:'high'},{s:'k·ªç',t:'mid'},{s:'mi',t:'mid'},{s:'ni',t:'mid'}], context: 'How you introduce yourself. Example: "Or√∫k·ªç mi ni David."' },
      { yoruba: '·∫∏b√≠', english: 'Family', phonetic: 'EH-bee', tones: [{s:'·∫∏',t:'mid'},{s:'b√≠',t:'high'}], context: 'Family is central to Yoruba life. "·∫∏b√≠ mi" = my family.' },
      { yoruba: '√Ä√°n√∫', english: 'Love / Mercy', phonetic: 'AH-noo', tones: [{s:'√Ä√°',t:'low'},{s:'n√∫',t:'high'}], context: 'Deep love or compassion. "Mo n√≠f·∫πÃÄ·∫π r·∫π" is "I love you."' },
    ],
    dialogues: [
      {
        scene: 'Grandma\'s friend visits and asks who you are.',
        steps: [
          { speaker: 'grandma', yoruba: 'W√°, s·ªç or√∫k·ªç r·∫π f√∫n M√†m√° Ad√©.', english: 'Come, tell Mama Ade your name.' },
          {
            speaker: 'you', prompt: 'Introduce yourself:',
            choices: [
              { yoruba: 'Or√∫k·ªç mi ni... Mo j·∫πÃÅ ·ªçm·ªç ·ªçm·ªç r·∫πÃÄ.', english: 'My name is... I am her grandchild.', correct: true },
              { yoruba: '·∫∏ k√∫ √†√°r·ªçÃÄ', english: 'Good morning', correct: false },
              { yoruba: '·∫∏ ·π£√©', english: 'Thank you', correct: false },
            ]
          },
          { speaker: 'grandma', yoruba: '·ªåm·ªç mi ni y√¨√≠! √ì d√°ra p√∫p·ªçÃÄ.', english: 'This is my grandchild! Very good.' },
          {
            speaker: 'you', prompt: 'Thank grandma\'s friend:',
            choices: [
              { yoruba: '√ì d√†b·ªçÃÄ', english: 'Goodbye', correct: false },
              { yoruba: '·∫∏ ·π£√©, M√†m√° Ad√©.', english: 'Thank you, Mama Ade.', correct: true },
              { yoruba: 'B√†w·ªçÃÅ ni?', english: 'How are you?', correct: false },
            ]
          }
        ]
      }
    ],
    culture: {
      title: 'Family Structure in Yoruba Culture',
      paragraphs: [
        'In Yoruba culture, "family" extends far beyond the nuclear family. Cousins are treated like siblings, your parents\' friends are "aunties" and "uncles," and the community plays a major role in raising children.',
        'Age determines everything in family dynamics. You always greet elders first, use respectful pronouns ("·∫∏" instead of "O"), and defer to those older than you. This is not about being submissive ‚Äî it\'s about showing recognition and love.',
        'Your grandma likely expects you to know your family lineage. Yoruba names often tell a story ‚Äî they can describe the circumstances of a child\'s birth, the family\'s faith, or hopes for the child\'s future.',
      ],
      highlight: 'Ask your grandma: "K√≠ ni √¨t√†n or√∫k·ªç mi?" (What is the story of my name?). She will love telling you, and it\'s a beautiful way to connect.'
    }
  },

  // ‚îÄ‚îÄ‚îÄ UNIT 3: EVERYDAY CONVERSATIONS ‚îÄ‚îÄ‚îÄ
  {
    id: 'everyday',
    title: 'Everyday Talk',
    subtitle: 'Feelings, needs, and daily expressions',
    emoji: 'üí¨',
    vocab: [
      { yoruba: 'Mo w√† d√°ad√°a', english: 'I am fine', phonetic: 'moh wah DAH-dah', tones: [{s:'Mo',t:'mid'},{s:'w√†',t:'low'},{s:'d√°a',t:'high'},{s:'d√°a',t:'high'}], context: 'The standard response when someone asks how you are.' },
      { yoruba: 'Ebi ≈Ñ pa m√≠', english: 'I am hungry', phonetic: 'EH-bee n pa mee', tones: [{s:'E',t:'mid'},{s:'bi',t:'mid'},{s:'≈Ñ',t:'mid'},{s:'pa',t:'mid'},{s:'m√≠',t:'high'}], context: 'Literally "hunger is killing me." Grandma will feed you immediately!' },
      { yoruba: 'Omi', english: 'Water', phonetic: 'oh-MEE', tones: [{s:'O',t:'mid'},{s:'mi',t:'mid'}], context: '"Mo f·∫πÃÅ omi" = I want water.' },
      { yoruba: 'Mo d√∫p·∫πÃÅ', english: 'I am grateful', phonetic: 'moh DOO-peh', tones: [{s:'Mo',t:'mid'},{s:'d√∫',t:'high'},{s:'p·∫πÃÅ',t:'high'}], context: 'A deeper thank you, expressing real gratitude.' },
      { yoruba: '√ì d√°ra', english: 'It is good / fine', phonetic: 'oh DAH-rah', tones: [{s:'√ì',t:'high'},{s:'d√°',t:'high'},{s:'ra',t:'mid'}], context: 'Used to agree or say something is fine.' },
      { yoruba: 'J·ªçÃÄw·ªçÃÅ', english: 'Please', phonetic: 'JOH-woh', tones: [{s:'J·ªçÃÄ',t:'low'},{s:'w·ªçÃÅ',t:'high'}], context: 'Essential polite word. Use before requests.' },
      { yoruba: 'M√° b√≠n√∫', english: 'Don\'t be angry / Sorry', phonetic: 'mah BEE-noo', tones: [{s:'M√°',t:'high'},{s:'b√≠',t:'high'},{s:'n√∫',t:'high'}], context: 'Used to apologize or calm someone. Very useful!' },
      { yoruba: 'Mo n√≠f·∫πÃÄ·∫π r·∫π', english: 'I love you', phonetic: 'moh NEE-feh reh', tones: [{s:'Mo',t:'mid'},{s:'n√≠',t:'high'},{s:'f·∫πÃÄ',t:'low'},{s:'·∫π',t:'mid'},{s:'r·∫π',t:'mid'}], context: 'Tell grandma this. It will make her day.' },
      { yoruba: 'B·∫πÃÅ·∫πÃÄ ni', english: 'Yes / That\'s right', phonetic: 'BEH-nee', tones: [{s:'B·∫πÃÅ',t:'high'},{s:'·∫πÃÄ',t:'low'},{s:'ni',t:'mid'}], context: 'To agree with someone or say yes.' },
      { yoruba: 'B·∫πÃÅ·∫πÃÄ k·ªçÃÅ', english: 'No / That\'s not right', phonetic: 'BEH-koh', tones: [{s:'B·∫πÃÅ',t:'high'},{s:'·∫πÃÄ',t:'low'},{s:'k·ªçÃÅ',t:'high'}], context: 'To disagree or say no.' },
    ],
    dialogues: [
      {
        scene: 'Grandma asks how you\'re doing and if you need anything.',
        steps: [
          { speaker: 'grandma', yoruba: '·π¢√© o w√† d√°ad√°a?', english: 'Are you fine?' },
          {
            speaker: 'you', prompt: 'Tell her you\'re fine:',
            choices: [
              { yoruba: 'Mo w√† d√°ad√°a, M√†m√°. ·∫∏ ·π£√©.', english: 'I am fine, Mama. Thank you.', correct: true },
              { yoruba: 'Ebi ≈Ñ pa m√≠', english: 'I am hungry', correct: false },
              { yoruba: 'B·∫πÃÅ·∫πÃÄ k·ªçÃÅ', english: 'No', correct: false },
            ]
          },
          { speaker: 'grandma', yoruba: '·π¢√© ebi ≈Ñ pa ·ªçÃÅ?', english: 'Are you hungry?' },
          {
            speaker: 'you', prompt: 'Tell her yes, you\'re a bit hungry:',
            choices: [
              { yoruba: 'M√° b√≠n√∫', english: 'Sorry', correct: false },
              { yoruba: 'B·∫πÃÅ·∫πÃÄ ni, M√†m√°. Ebi ≈Ñ pa m√≠ d√≠·∫πÃÄ.', english: 'Yes, Mama. I\'m a little hungry.', correct: true },
              { yoruba: '√ì d√†b·ªçÃÄ', english: 'Goodbye', correct: false },
            ]
          },
          { speaker: 'grandma', yoruba: '√ì d√°ra! M√° b·ªçÃÄ, o√∫nj·∫π ti ·π£et√°n.', english: 'Good! Come, food is ready.' },
          {
            speaker: 'you', prompt: 'Express gratitude:',
            choices: [
              { yoruba: 'Mo d√∫p·∫πÃÅ, M√†m√°! Mo n√≠f·∫πÃÄ·∫π r·∫π.', english: 'I\'m grateful, Mama! I love you.', correct: true },
              { yoruba: 'B·∫πÃÅ·∫πÃÄ k·ªçÃÅ', english: 'No', correct: false },
              { yoruba: '·∫∏ k√∫ √†√°r·ªçÃÄ', english: 'Good morning', correct: false },
            ]
          }
        ]
      }
    ],
    culture: {
      title: 'The Art of Yoruba Politeness',
      paragraphs: [
        '"J·ªçÃÄw·ªçÃÅ" (please) and "·∫∏ ·π£√©" (thank you) go a long way, but Yoruba politeness runs deeper than just words. Tone of voice, body language, and timing all matter. Speaking softly to elders, not interrupting, and responding promptly to greetings are all important.',
        '"M√° b√≠n√∫" is one of the most useful phrases you\'ll learn. It\'s used not just for genuine apologies but also as a softener ‚Äî before disagreeing, before asking a favor, or when you need to get someone\'s attention. Think of it like "excuse me" and "I\'m sorry" combined.',
        'When grandma offers you food, the polite response is to accept with both hands and say "·∫∏ ·π£√©, M√†m√°." Declining food from an elder can sometimes be seen as disrespectful, though a gentle "Mo ti j·∫πun" (I have eaten) works if you truly can\'t eat.',
      ],
      highlight: 'Pro tip: If grandma gives you food, take at least a little. Then say "√ì d√πn p√∫p·ªçÃÄ!" (It\'s very delicious!). She will absolutely love this.'
    }
  },

  // ‚îÄ‚îÄ‚îÄ UNIT 4: FOOD & HOME ‚îÄ‚îÄ‚îÄ
  {
    id: 'food-home',
    title: 'Food & Home',
    subtitle: 'Eating together and life around the house',
    emoji: 'üç≤',
    vocab: [
      { yoruba: 'O√∫nj·∫π', english: 'Food', phonetic: 'oh-OON-jeh', tones: [{s:'O',t:'mid'},{s:'√∫n',t:'high'},{s:'j·∫π',t:'mid'}], context: 'General word for food. "O√∫nj·∫π ti ·π£et√°n" = food is ready.' },
      { yoruba: '√ì d√πn', english: 'It\'s delicious', phonetic: 'oh DOON', tones: [{s:'√ì',t:'high'},{s:'d√πn',t:'low'}], context: 'Tell grandma this after eating! "√ì d√πn p√∫p·ªçÃÄ" = very delicious.' },
      { yoruba: '√Äm√†l√†', english: 'Amala (yam flour dish)', phonetic: 'AH-mah-lah', tones: [{s:'√Ä',t:'low'},{s:'m√†',t:'low'},{s:'l√†',t:'low'}], context: 'A beloved Yoruba staple made from yam flour. Served with various soups.' },
      { yoruba: '·∫∏ÃÄw√†', english: 'Beans', phonetic: 'EH-wah', tones: [{s:'·∫∏ÃÄ',t:'low'},{s:'w√†',t:'low'}], context: 'Beans are a staple. "·∫∏ÃÄw√† √†g·ªçÃÄy√≠n" is a famous honey beans dish.' },
      { yoruba: '·ªåb·∫πÃÄ', english: 'Soup / Stew', phonetic: 'OH-beh', tones: [{s:'·ªå',t:'mid'},{s:'b·∫πÃÄ',t:'low'}], context: 'Soups are eaten with fufu, amala, or pounded yam.' },
      { yoruba: 'Il√©', english: 'House / Home', phonetic: 'ee-LEH', tones: [{s:'I',t:'mid'},{s:'l√©',t:'high'}], context: '"Il√© wa" = our house. "Mo f·∫πÃÅ l·ªç s√≠ il√©" = I want to go home.' },
      { yoruba: 'Omi t√∫t√π', english: 'Cold water', phonetic: 'oh-MEE TOO-too', tones: [{s:'O',t:'mid'},{s:'mi',t:'mid'},{s:'t√∫',t:'high'},{s:'t√π',t:'low'}], context: 'Very useful in hot weather! "F√∫n mi n√≠ omi t√∫t√π, j·ªçÃÄw·ªçÃÅ" = give me cold water, please.' },
      { yoruba: 'J·∫πun', english: 'To eat', phonetic: 'JEH-oon', tones: [{s:'J·∫π',t:'mid'},{s:'un',t:'mid'}], context: '"·∫∏ w√° j·∫πun" = come and eat. You\'ll hear this a lot!' },
      { yoruba: '√åd√≠l√©', english: 'Household / Family home', phonetic: 'EE-dee-leh', tones: [{s:'√å',t:'low'},{s:'d√≠',t:'high'},{s:'l√©',t:'high'}], context: 'Refers to the family compound or household.' },
      { yoruba: 'S√πn', english: 'To sleep', phonetic: 'soon', tones: [{s:'S√πn',t:'low'}], context: '"Mo f·∫πÃÅ s√πn" = I want to sleep. "√ì t√≥ √†k√≥k√≤ s√πn" = it\'s time to sleep.' },
    ],
    dialogues: [
      {
        scene: 'Grandma calls you to come eat dinner.',
        steps: [
          { speaker: 'grandma', yoruba: '·ªåm·ªç mi, ·∫π w√° j·∫πun! √Äm√†l√† √†ti ·∫πÃÄf·ªçÃÅ r√≠r√≤ ti ·π£et√°n.', english: 'My child, come eat! Amala and vegetable soup is ready.' },
          {
            speaker: 'you', prompt: 'Respond to grandma:',
            choices: [
              { yoruba: 'Mo ≈Ñ b·ªçÃÄ, M√†m√°! ·∫∏ ·π£√©.', english: 'I\'m coming, Mama! Thank you.', correct: true },
              { yoruba: 'Mo f·∫πÃÅ s√πn', english: 'I want to sleep', correct: false },
              { yoruba: 'B·∫πÃÅ·∫πÃÄ k·ªçÃÅ', english: 'No', correct: false },
            ]
          },
          { speaker: 'grandma', yoruba: '·π¢√© √≥ d√πn?', english: 'Is it delicious?' },
          {
            speaker: 'you', prompt: 'Compliment the food:',
            choices: [
              { yoruba: '√ì d√°ra', english: 'It\'s fine', correct: false },
              { yoruba: '√ì d√πn p√∫p·ªçÃÄ, M√†m√°! Mo d√∫p·∫πÃÅ.', english: 'Very delicious, Mama! I\'m grateful.', correct: true },
              { yoruba: 'Ebi ≈Ñ pa m√≠', english: 'I\'m hungry', correct: false },
            ]
          }
        ]
      }
    ],
    culture: {
      title: 'Food Is Love in Yoruba Culture',
      paragraphs: [
        'In Yoruba homes, food is one of the primary ways love is expressed. When grandma cooks for you, she is showing deep care. Refusing food or not showing appreciation can unintentionally hurt feelings.',
        'Many Yoruba dishes are eaten communally, sometimes from a shared bowl. Elders eat first or are served the best portions. When eating with your hands (the traditional way), always use your right hand.',
        'Common staples include amala (yam flour), pounded yam (iy√°n), ·∫πÃÄb√† (cassava flour), and various soups like ·∫πÃÄf·ªçÃÅ r√≠r√≤ (vegetable soup), ·∫πÃÄg√∫s√≠ (melon seed soup), and gb·∫πÃÄg√¨r√¨ (bean soup). Learning to name these dishes will delight your grandma.',
      ],
      highlight: 'After eating, always say "·∫∏ ·π£√© f√∫n o√∫nj·∫π, M√†m√°" (Thank you for the food, Mama). If you can add "√ì d√πn gan-an!" (It was really delicious!), even better.'
    }
  },

  // ‚îÄ‚îÄ‚îÄ UNIT 5: NUMBERS, TIME & PLACES ‚îÄ‚îÄ‚îÄ
  {
    id: 'numbers-time',
    title: 'Numbers, Time & Places',
    subtitle: 'Counting, days, and getting around',
    emoji: 'üî¢',
    vocab: [
      { yoruba: '·ªåÃÄkan', english: 'One', phonetic: 'OH-kan', tones: [{s:'·ªåÃÄ',t:'low'},{s:'kan',t:'mid'}], context: 'The number one. Yoruba counting is base-20 (vigesimal)!' },
      { yoruba: '√àj√¨', english: 'Two', phonetic: 'EH-jee', tones: [{s:'√à',t:'low'},{s:'j√¨',t:'low'}], context: 'Two of something.' },
      { yoruba: '·∫∏ÃÄta', english: 'Three', phonetic: 'EH-tah', tones: [{s:'·∫∏ÃÄ',t:'low'},{s:'ta',t:'mid'}], context: 'The number three.' },
      { yoruba: '·∫∏ÃÄrin', english: 'Four', phonetic: 'EH-reen', tones: [{s:'·∫∏ÃÄ',t:'low'},{s:'rin',t:'mid'}], context: 'The number four.' },
      { yoruba: '√Är√∫n', english: 'Five', phonetic: 'AH-roon', tones: [{s:'√Ä',t:'low'},{s:'r√∫n',t:'high'}], context: 'Five. From here, numbers get more complex!' },
      { yoruba: '·ªåj·ªçÃÅ', english: 'Day', phonetic: 'oh-JOH', tones: [{s:'·ªå',t:'mid'},{s:'j·ªçÃÅ',t:'high'}], context: '"·ªåj·ªçÃÅ wo ni?" = What day is it?' },
      { yoruba: '·ªåÃÄla', english: 'Tomorrow', phonetic: 'OH-lah', tones: [{s:'·ªåÃÄ',t:'low'},{s:'la',t:'mid'}], context: '"√àmi y√≥√≤ w√° n√≠ ·ªçÃÄla" = I will come tomorrow.' },
      { yoruba: '√Än√°', english: 'Yesterday', phonetic: 'AH-nah', tones: [{s:'√Ä',t:'low'},{s:'n√°',t:'high'}], context: '"Mo w√° n√≠ √†n√°" = I came yesterday.' },
      { yoruba: '·ªåj√†', english: 'Market', phonetic: 'oh-JAH', tones: [{s:'·ªå',t:'mid'},{s:'j√†',t:'low'}], context: 'Markets are central to Yoruba life. "Mo f·∫πÃÅ l·ªç s√≠ ·ªçj√†" = I want to go to market.' },
      { yoruba: 'Ibi', english: 'Place', phonetic: 'EE-bee', tones: [{s:'I',t:'mid'},{s:'bi',t:'mid'}], context: '"Ibi y√¨√≠ d√°ra" = This place is good.' },
    ],
    dialogues: [
      {
        scene: 'You and grandma are planning tomorrow.',
        steps: [
          { speaker: 'grandma', yoruba: '·π¢√© o m√°a w√° n√≠ ·ªçÃÄla?', english: 'Will you come tomorrow?' },
          {
            speaker: 'you', prompt: 'Tell her yes, you\'ll come tomorrow:',
            choices: [
              { yoruba: 'B·∫πÃÅ·∫πÃÄ ni, M√†m√°. √àmi y√≥√≤ w√° n√≠ ·ªçÃÄla.', english: 'Yes, Mama. I will come tomorrow.', correct: true },
              { yoruba: 'B·∫πÃÅ·∫πÃÄ k·ªçÃÅ', english: 'No', correct: false },
              { yoruba: 'Mo w√† d√°ad√°a', english: 'I am fine', correct: false },
            ]
          },
          { speaker: 'grandma', yoruba: '√ì d√°ra! ·π¢√© o f·∫πÃÅ l·ªç s√≠ ·ªçj√† p·∫πÃÄl√∫ mi?', english: 'Good! Do you want to go to market with me?' },
          {
            speaker: 'you', prompt: 'Accept her invitation:',
            choices: [
              { yoruba: 'M√° b√≠n√∫, M√†m√°', english: 'Sorry, Mama', correct: false },
              { yoruba: 'B·∫πÃÅ·∫πÃÄ ni! Mo f·∫πÃÅ l·ªç p·∫πÃÄl√∫ r·∫π, M√†m√°.', english: 'Yes! I want to go with you, Mama.', correct: true },
              { yoruba: '√ì d√†b·ªçÃÄ', english: 'Goodbye', correct: false },
            ]
          }
        ]
      }
    ],
    culture: {
      title: 'The Yoruba Market Experience',
      paragraphs: [
        'Markets (·ªçj√†) are the heartbeat of Yoruba communities. They\'re not just places to buy things ‚Äî they are social hubs where news is shared, friendships are maintained, and business relationships span generations.',
        'Going to market with grandma is a wonderful bonding experience. She likely knows every vendor, will negotiate prices with flair, and can teach you the names of ingredients, fabrics, and household items in Yoruba.',
        'Yoruba traditionally uses a base-20 number system, which is mathematically fascinating but can be complex. For daily use, knowing 1-10 and being able to ask "·∫∏ÃÄlo ni?" (How much?) will get you far in the market.',
      ],
      highlight: 'At the market, try asking "·∫∏ÃÄlo ni √®y√≠?" (How much is this?) while pointing at items. Grandma will be thrilled to see you using Yoruba in the real world.'
    }
  },

  // ‚îÄ‚îÄ‚îÄ UNIT 6: PROVERBS & CULTURE ‚îÄ‚îÄ‚îÄ
  {
    id: 'proverbs',
    title: 'Proverbs & Deeper Talk',
    subtitle: 'Wisdom, blessings, and meaningful phrases',
    emoji: 'üìñ',
    vocab: [
      { yoruba: '√Ä·π£·∫π', english: 'Amen / Power / Authority', phonetic: 'AH-sheh', tones: [{s:'√Ä',t:'low'},{s:'·π£·∫π',t:'mid'}], context: 'Said after prayers and blessings. When grandma prays for you, say "√Ä·π£·∫π!"' },
      { yoruba: 'Ol√∫wa', english: 'God / Lord', phonetic: 'oh-LOO-wah', tones: [{s:'O',t:'mid'},{s:'l√∫',t:'high'},{s:'wa',t:'mid'}], context: 'References to God are common in everyday Yoruba speech.' },
      { yoruba: 'Mo r√≠ ·ªçÃÄ', english: 'I see you / I acknowledge you', phonetic: 'moh ree oh', tones: [{s:'Mo',t:'mid'},{s:'r√≠',t:'high'},{s:'·ªçÃÄ',t:'low'}], context: 'A deep acknowledgement. When you say this to grandma, it means you truly see her.' },
      { yoruba: '·ªåm·ªçl√∫w√†b√≠', english: 'Person of good character', phonetic: 'oh-moh-loo-WAH-bee', tones: [{s:'·ªå',t:'mid'},{s:'m·ªç',t:'mid'},{s:'l√∫',t:'high'},{s:'w√†',t:'low'},{s:'b√≠',t:'high'}], context: 'The highest Yoruba compliment. Means a person of integrity and good upbringing.' },
      { yoruba: '·∫∏ k√∫ or√≠ire', english: 'Congratulations', phonetic: 'eh koo oh-REE-reh', tones: [{s:'·∫∏',t:'mid'},{s:'k√∫',t:'high'},{s:'o',t:'mid'},{s:'r√≠',t:'high'},{s:'i',t:'mid'},{s:'re',t:'mid'}], context: 'Used for celebrations, achievements, and happy events.' },
      { yoruba: '·ªåÃÄr·ªçÃÄ t√≥ d√πn', english: 'Sweet/good words', phonetic: 'OH-roh toh doon', tones: [{s:'·ªåÃÄ',t:'low'},{s:'r·ªçÃÄ',t:'low'},{s:'t√≥',t:'high'},{s:'d√πn',t:'low'}], context: 'When someone speaks well or says something nice.' },
      { yoruba: '√Äl√†√°f√≠√†', english: 'Peace / Good health', phonetic: 'ah-LAH-fee-ah', tones: [{s:'√Ä',t:'low'},{s:'l√†',t:'low'},{s:'√°',t:'high'},{s:'f√≠',t:'high'},{s:'√†',t:'low'}], context: 'A greeting and a wish. "√Äl√†√°f√≠√† ni" = it is peaceful/all is well.' },
      { yoruba: '√år√®t√≠', english: 'Hope', phonetic: 'EE-reh-tee', tones: [{s:'√å',t:'low'},{s:'r√®',t:'low'},{s:'t√≠',t:'high'}], context: 'A beautiful concept. "Mo n√≠ √¨r√®t√≠" = I have hope.' },
      { yoruba: '√å·π£·∫πÃÅgun', english: 'Victory', phonetic: 'ee-SHEH-goon', tones: [{s:'√å',t:'low'},{s:'·π£·∫πÃÅ',t:'high'},{s:'gun',t:'mid'}], context: 'Used in prayers and blessings. "√å·π£·∫πÃÅgun ni ti wa" = Victory is ours.' },
      { yoruba: '·ªåm·ªç t√≠ a k√≤ k·ªçÃÅ...', english: 'A child we didn\'t teach... (proverb start)', phonetic: 'oh-moh tee ah koh koh', tones: [{s:'·ªå',t:'mid'},{s:'m·ªç',t:'mid'},{s:'t√≠',t:'high'},{s:'a',t:'mid'},{s:'k√≤',t:'low'},{s:'k·ªçÃÅ',t:'high'}], context: 'Start of the proverb: "A child we didn\'t teach will sell the house that trained them." Education matters.' },
    ],
    dialogues: [
      {
        scene: 'Grandma is blessing you before you leave.',
        steps: [
          { speaker: 'grandma', yoruba: 'Ol√∫wa √° b√πk√∫n ·ªç, ·ªçm·ªç mi.', english: 'God will bless you, my child.' },
          {
            speaker: 'you', prompt: 'Receive the blessing:',
            choices: [
              { yoruba: '√Ä·π£·∫π, M√†m√°! ·∫∏ ·π£√©.', english: 'Amen, Mama! Thank you.', correct: true },
              { yoruba: '√ì d√°ra', english: 'It\'s fine', correct: false },
              { yoruba: 'B·∫πÃÅ·∫πÃÄ k·ªçÃÅ', english: 'No', correct: false },
            ]
          },
          { speaker: 'grandma', yoruba: '·ªåm·ªçl√∫w√†b√≠ ni ·∫π. In√∫ mi d√πn.', english: 'You are a person of good character. I am happy.' },
          {
            speaker: 'you', prompt: 'Tell grandma you love her and will return:',
            choices: [
              { yoruba: 'Mo n√≠f·∫πÃÄ·∫π r·∫π, M√†m√°. √àmi y√≥√≤ pad√† w√°.', english: 'I love you, Mama. I will come back.', correct: true },
              { yoruba: '·∫∏ k√∫ i·π£·∫πÃÅ', english: 'Greetings for your work', correct: false },
              { yoruba: 'Ebi ≈Ñ pa m√≠', english: 'I\'m hungry', correct: false },
            ]
          }
        ]
      }
    ],
    culture: {
      title: 'Yoruba Proverbs: The Voice of the Elders',
      paragraphs: [
        'Yoruba proverbs (√≤we) are considered the "horse of speech" ‚Äî when a conversation loses its way, a proverb helps it find its path. Elders use proverbs to teach, warn, comfort, and connect. Understanding even a few will deepen your conversations with grandma tremendously.',
        'Blessings are a central part of Yoruba elder-youth relationships. When an elder blesses you, always respond with "√Ä·π£·∫π" (Amen/So be it). These blessings are taken very seriously and are considered spiritually powerful.',
        'The concept of "·ªåm·ªçl√∫w√†b√≠" ‚Äî being a person of good character ‚Äî is perhaps the most important value in Yoruba culture. It encompasses honesty, respect, hard work, humility, and caring for community. When grandma calls you an ·ªåm·ªçl√∫w√†b√≠, it is the highest praise.',
      ],
      highlight: 'Before leaving grandma, kneel (or bow) and ask for her blessing: "M√†m√°, ·∫π gb√†d√∫r√† f√∫n mi" (Mama, pray for me). This is a profound moment of connection that she will treasure.'
    }
  }
];


// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// APP STATE & STORAGE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const STORAGE_KEY = 'eko_yoruba_progress';

function loadProgress() {
  try {
    const data = localStorage.getItem(STORAGE_KEY);
    if (data) return JSON.parse(data);
  } catch(e) {}
  return { completedLessons: {}, flashcardData: {}, quizScores: {}, streak: 0, lastVisit: null, wordsLearned: 0 };
}

function saveProgress(progress) {
  try { localStorage.setItem(STORAGE_KEY, JSON.stringify(progress)); } catch(e) {}
}

let progress = loadProgress();
let currentView = 'home';
let currentUnit = 0;
let currentLesson = null;
let vocabIndex = 0;
let flashcardFlipped = false;
let quizState = {};
let dialogueState = {};

// Update streak
const today = new Date().toDateString();
if (progress.lastVisit !== today) {
  const yesterday = new Date(Date.now() - 86400000).toDateString();
  if (progress.lastVisit === yesterday) {
    progress.streak++;
  } else if (progress.lastVisit) {
    progress.streak = 1;
  } else {
    progress.streak = 1;
  }
  progress.lastVisit = today;
  saveProgress(progress);
}


// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SPEECH SYNTHESIS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function speak(text) {
  if (!('speechSynthesis' in window)) return;
  window.speechSynthesis.cancel();
  const utter = new SpeechSynthesisUtterance(text);
  // Try to find a Yoruba voice, fallback to default
  const voices = window.speechSynthesis.getVoices();
  const yorubaVoice = voices.find(v => v.lang && v.lang.startsWith('yo'));
  if (yorubaVoice) {
    utter.voice = yorubaVoice;
    utter.lang = 'yo-NG';
  } else {
    utter.lang = 'yo-NG';
  }
  utter.rate = 0.8;
  utter.pitch = 1;
  window.speechSynthesis.speak(utter);
}

// Load voices
if ('speechSynthesis' in window) {
  speechSynthesis.onvoiceschanged = () => speechSynthesis.getVoices();
  speechSynthesis.getVoices();
}


// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RENDER FUNCTIONS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const app = document.getElementById('app');

function render() {
  switch(currentView) {
    case 'home': renderHome(); break;
    case 'unit': renderUnit(); break;
    case 'vocab': renderVocab(); break;
    case 'flashcards': renderFlashcards(); break;
    case 'quiz': renderQuiz(); break;
    case 'dialogue': renderDialogue(); break;
    case 'culture': renderCulture(); break;
    case 'complete': renderComplete(); break;
  }
}

function lessonKey(unitIdx, type) { return `${unitIdx}-${type}`; }

function isLessonDone(unitIdx, type) {
  return progress.completedLessons[lessonKey(unitIdx, type)] === true;
}

function markLessonDone(unitIdx, type) {
  progress.completedLessons[lessonKey(unitIdx, type)] = true;
  saveProgress(progress);
}

function getTotalWords() {
  let count = 0;
  CURRICULUM.forEach((unit, i) => {
    if (isLessonDone(i, 'vocab') || isLessonDone(i, 'flashcards')) {
      count += unit.vocab.length;
    }
  });
  return count;
}

function getTotalLessons() {
  return Object.keys(progress.completedLessons).filter(k => progress.completedLessons[k]).length;
}

function getOverallProgress() {
  const total = CURRICULUM.length * 5; // 5 lessons per unit
  const done = getTotalLessons();
  return Math.round((done / total) * 100);
}

// ‚îÄ‚îÄ‚îÄ SVG Icons ‚îÄ‚îÄ‚îÄ
const ICONS = {
  back: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 18l-6-6 6-6"/></svg>',
  check: '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3"><path d="M20 6L9 17l-5-5"/></svg>',
  speaker: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 5L6 9H2v6h4l5 4V5z"/><path d="M19.07 4.93a10 10 0 010 14.14M15.54 8.46a5 5 0 010 7.07"/></svg>',
};


// ‚îÄ‚îÄ‚îÄ HOME ‚îÄ‚îÄ‚îÄ
function renderHome() {
  const pct = getOverallProgress();
  const words = getTotalWords();
  const lessons = getTotalLessons();

  app.innerHTML = `
    <div class="header">
      <div style="width:40px"></div>
      <div class="header-title">√àk√≥ Yor√πb√°</div>
      <div class="header-streak">üî• ${progress.streak}</div>
    </div>
    <div class="home fade-in">
      <div class="home-hero">
        <h1>√àk√≥ Yor√πb√°</h1>
        <p>Learn to speak with grandma</p>
      </div>

      <div class="progress-overview">
        <div class="progress-bar-container">
          <div class="progress-bar">
            <div class="progress-bar-fill" style="width: ${pct}%"></div>
          </div>
          <span class="progress-label">${pct}%</span>
        </div>
        <div class="progress-stats">
          <div class="progress-stat">
            <div class="progress-stat-num">${words}</div>
            <div class="progress-stat-label">Words</div>
          </div>
          <div class="progress-stat">
            <div class="progress-stat-num">${lessons}</div>
            <div class="progress-stat-label">Lessons</div>
          </div>
          <div class="progress-stat">
            <div class="progress-stat-num">${progress.streak}</div>
            <div class="progress-stat-label">Day Streak</div>
          </div>
        </div>
      </div>

      <div class="section-title">Your Journey</div>
      ${CURRICULUM.map((unit, i) => {
        const lessonTypes = ['vocab','flashcards','quiz','dialogue','culture'];
        const doneCount = lessonTypes.filter(t => isLessonDone(i, t)).length;
        const isLocked = i > 0 && lessonTypes.filter(t => isLessonDone(i-1, t)).length < 3;
        return `
          <div class="unit-card ${isLocked ? 'locked' : ''}" onclick="openUnit(${i})">
            <div class="unit-card-header">
              <span class="unit-num">Unit ${i+1}</span>
              <span class="unit-emoji">${unit.emoji}</span>
            </div>
            <h3>${unit.title}</h3>
            <p>${unit.subtitle}</p>
            <div class="unit-lessons">
              ${lessonTypes.map(t => `<div class="unit-lesson-dot ${isLessonDone(i,t) ? 'done' : ''}"></div>`).join('')}
            </div>
          </div>
        `;
      }).join('')}

      <button class="review-btn" onclick="startReview()">üîÑ Review All Learned Words</button>
    </div>
  `;
}


// ‚îÄ‚îÄ‚îÄ UNIT VIEW ‚îÄ‚îÄ‚îÄ
function openUnit(idx) {
  currentUnit = idx;
  currentView = 'unit';
  render();
}

function renderUnit() {
  const unit = CURRICULUM[currentUnit];
  const lessons = [
    { type: 'vocab', icon: 'vocab', title: 'Vocabulary', desc: `${unit.vocab.length} words to learn` },
    { type: 'flashcards', icon: 'flash', title: 'Flashcards', desc: 'Review with spaced repetition' },
    { type: 'quiz', icon: 'quiz', title: 'Quiz', desc: 'Test your knowledge' },
    { type: 'dialogue', icon: 'dialogue', title: 'Conversation', desc: 'Practice with grandma' },
    { type: 'culture', icon: 'culture', title: 'Culture Note', desc: 'Understand the context' },
  ];

  app.innerHTML = `
    <div class="header">
      <button class="header-back" onclick="goHome()">${ICONS.back}</button>
      <div class="header-title">${unit.emoji} Unit ${currentUnit+1}</div>
      <div style="width:40px"></div>
    </div>
    <div class="unit-view fade-in">
      <div class="unit-view-header">
        <h2>${unit.title}</h2>
        <p>${unit.subtitle}</p>
      </div>
      ${lessons.map((l, i) => {
        const done = isLessonDone(currentUnit, l.type);
        const locked = i > 0 && !isLessonDone(currentUnit, lessons[i-1].type) && !done;
        return `
          <div class="lesson-card ${locked ? 'locked' : ''}" onclick="openLesson('${l.type}')">
            <div class="lesson-icon ${done ? 'done' : l.icon}">
              ${done ? '‚úì' : l.type === 'vocab' ? 'üìù' : l.type === 'flashcards' ? 'üÉè' : l.type === 'quiz' ? '‚ùì' : l.type === 'dialogue' ? 'üí¨' : 'üåç'}
            </div>
            <div class="lesson-info">
              <h4>${l.title}</h4>
              <p>${l.desc}</p>
            </div>
            <div class="lesson-check ${done ? 'done' : ''}">
              ${done ? ICONS.check : ''}
            </div>
          </div>
        `;
      }).join('')}
    </div>
  `;
}

function openLesson(type) {
  currentLesson = type;
  currentView = type;
  vocabIndex = 0;
  flashcardFlipped = false;

  if (type === 'quiz') {
    const unit = CURRICULUM[currentUnit];
    const questions = generateQuiz(unit);
    quizState = { questions, current: 0, answers: [], answered: false };
  }

  if (type === 'dialogue') {
    dialogueState = { stepIndex: 0, messages: [], answered: false, done: false };
  }

  render();
}


// ‚îÄ‚îÄ‚îÄ VOCABULARY ‚îÄ‚îÄ‚îÄ
function renderVocab() {
  const unit = CURRICULUM[currentUnit];
  const word = unit.vocab[vocabIndex];

  app.innerHTML = `
    <div class="header">
      <button class="header-back" onclick="backToUnit()">${ICONS.back}</button>
      <div class="header-title">Vocabulary</div>
      <div style="width:40px"></div>
    </div>
    <div class="vocab-view fade-in">
      <div class="vocab-counter">${vocabIndex + 1} of ${unit.vocab.length}</div>

      <div class="vocab-card">
        <div class="vocab-yoruba">${word.yoruba}</div>
        <div class="vocab-phonetic">/${word.phonetic}/</div>

        <button class="speak-btn" onclick="speak('${word.yoruba.replace(/'/g, "\\'")}')">
          ${ICONS.speaker}
        </button>

        <div class="vocab-english">${word.english}</div>
        <div class="vocab-context">${word.context}</div>
      </div>

      <div class="tone-legend">
        <div class="tone-legend-item"><div class="tone-legend-dot high"></div> High</div>
        <div class="tone-legend-item"><div class="tone-legend-dot mid"></div> Mid</div>
        <div class="tone-legend-item"><div class="tone-legend-dot low"></div> Low</div>
      </div>

      <div class="tone-display">
        ${word.tones.map(t => `
          <div class="tone-syllable">
            <div class="tone-bar ${t.t}"></div>
            <div class="tone-label">${t.s}</div>
          </div>
        `).join('')}
      </div>

      <div class="vocab-nav">
        ${vocabIndex > 0 ? `<button class="vocab-nav-btn" onclick="prevVocab()">‚Üê Back</button>` : ''}
        ${vocabIndex < unit.vocab.length - 1
          ? `<button class="vocab-nav-btn primary" onclick="nextVocab()">Next ‚Üí</button>`
          : `<button class="vocab-nav-btn primary" onclick="finishVocab()">Complete ‚úì</button>`
        }
      </div>
    </div>
  `;
}

function nextVocab() { vocabIndex++; render(); }
function prevVocab() { vocabIndex--; render(); }
function finishVocab() {
  markLessonDone(currentUnit, 'vocab');
  currentView = 'complete';
  render();
}


// ‚îÄ‚îÄ‚îÄ FLASHCARDS ‚îÄ‚îÄ‚îÄ
function renderFlashcards() {
  const unit = CURRICULUM[currentUnit];
  const word = unit.vocab[vocabIndex];

  app.innerHTML = `
    <div class="header">
      <button class="header-back" onclick="backToUnit()">${ICONS.back}</button>
      <div class="header-title">Flashcards</div>
      <div style="width:40px"></div>
    </div>
    <div class="vocab-view fade-in">
      <div class="vocab-counter">${vocabIndex + 1} of ${unit.vocab.length}</div>

      <div class="flashcard-area">
        <div class="flashcard ${flashcardFlipped ? 'flipped' : ''}" onclick="flipCard()">
          <div class="flashcard-front">
            <div class="vocab-yoruba">${word.yoruba}</div>
            <div class="vocab-phonetic">/${word.phonetic}/</div>
            <button class="speak-btn" onclick="event.stopPropagation(); speak('${word.yoruba.replace(/'/g, "\\'")}')">
              ${ICONS.speaker}
            </button>
            <div class="flashcard-tap">Tap to reveal</div>
          </div>
          <div class="flashcard-back">
            <div class="vocab-english" style="font-size: 24px;">${word.english}</div>
            <div class="vocab-context" style="margin-top: 12px;">${word.context}</div>
            <div class="tone-display" style="margin-top: 16px;">
              ${word.tones.map(t => `
                <div class="tone-syllable">
                  <div class="tone-bar ${t.t}"></div>
                  <div class="tone-label">${t.s}</div>
                </div>
              `).join('')}
            </div>
          </div>
        </div>
      </div>

      ${flashcardFlipped ? `
        <div class="flashcard-btns">
          <button class="flash-btn again" onclick="flashRate('again')">Again</button>
          <button class="flash-btn hard" onclick="flashRate('hard')">Hard</button>
          <button class="flash-btn good" onclick="flashRate('good')">Good</button>
        </div>
      ` : ''}
    </div>
  `;
}

function flipCard() { flashcardFlipped = true; render(); }

function flashRate(rating) {
  const unit = CURRICULUM[currentUnit];
  flashcardFlipped = false;
  if (vocabIndex < unit.vocab.length - 1) {
    vocabIndex++;
    render();
  } else {
    markLessonDone(currentUnit, 'flashcards');
    currentView = 'complete';
    render();
  }
}


// ‚îÄ‚îÄ‚îÄ QUIZ ‚îÄ‚îÄ‚îÄ
function generateQuiz(unit) {
  const questions = [];
  const vocab = [...unit.vocab];

  // Shuffle
  for (let i = vocab.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [vocab[i], vocab[j]] = [vocab[j], vocab[i]];
  }

  // Take up to 8 questions
  const selected = vocab.slice(0, Math.min(8, vocab.length));

  selected.forEach(word => {
    // Random question type
    const type = Math.random() > 0.5 ? 'yoruba-to-english' : 'english-to-yoruba';
    const allWords = unit.vocab.filter(w => w !== word);
    const shuffledOthers = allWords.sort(() => Math.random() - 0.5).slice(0, 3);

    if (type === 'yoruba-to-english') {
      const options = [
        { text: word.english, correct: true },
        ...shuffledOthers.map(w => ({ text: w.english, correct: false }))
      ].sort(() => Math.random() - 0.5);
      questions.push({ type, prompt: word.yoruba, options, speakText: word.yoruba });
    } else {
      const options = [
        { text: word.yoruba, correct: true },
        ...shuffledOthers.map(w => ({ text: w.yoruba, correct: false }))
      ].sort(() => Math.random() - 0.5);
      questions.push({ type, prompt: word.english, options, speakText: word.yoruba });
    }
  });

  return questions;
}

function renderQuiz() {
  const { questions, current, answers, answered } = quizState;

  if (current >= questions.length) {
    const correct = answers.filter(a => a).length;
    markLessonDone(currentUnit, 'quiz');
    app.innerHTML = `
      <div class="header">
        <button class="header-back" onclick="backToUnit()">${ICONS.back}</button>
        <div class="header-title">Quiz Results</div>
        <div style="width:40px"></div>
      </div>
      <div class="complete-screen fade-in">
        <div class="complete-emoji">${correct >= questions.length * 0.7 ? 'üéâ' : 'üí™'}</div>
        <h2>${correct >= questions.length * 0.7 ? '√ì d√°ra p√∫p·ªçÃÄ!' : 'Keep Practicing!'}</h2>
        <p>You got ${correct} out of ${questions.length} correct</p>
        <div class="vocab-nav">
          <button class="vocab-nav-btn" onclick="openLesson('quiz')">Try Again</button>
          <button class="vocab-nav-btn primary" onclick="backToUnit()">Continue</button>
        </div>
      </div>
    `;
    return;
  }

  const q = questions[current];

  app.innerHTML = `
    <div class="header">
      <button class="header-back" onclick="backToUnit()">${ICONS.back}</button>
      <div class="header-title">Quiz</div>
      <div style="width:40px"></div>
    </div>
    <div class="quiz-view fade-in">
      <div class="quiz-progress">
        ${questions.map((_, i) => `
          <div class="quiz-dot ${i < current ? (answers[i] ? 'correct' : 'wrong') : i === current ? 'current' : ''}"></div>
        `).join('')}
      </div>

      <div class="quiz-question">
        <div class="quiz-question-label">${q.type === 'yoruba-to-english' ? 'What does this mean?' : 'How do you say this in Yoruba?'}</div>
        <div class="quiz-question-text">${q.prompt}</div>
        ${q.type === 'yoruba-to-english' ? `
          <button class="speak-btn" style="margin-top:16px" onclick="speak('${q.speakText.replace(/'/g, "\\'")}')">
            ${ICONS.speaker}
          </button>
        ` : ''}
      </div>

      <div class="quiz-options">
        ${q.options.map((opt, i) => `
          <button class="quiz-option ${answered ? (opt.correct ? 'correct' : (quizState.selectedIdx === i ? 'wrong' : '')) : ''} ${answered ? 'disabled' : ''}"
            onclick="answerQuiz(${i}, ${opt.correct})">
            ${opt.text}
          </button>
        `).join('')}
      </div>

      ${answered ? `
        <div class="quiz-feedback ${quizState.lastCorrect ? 'correct' : 'wrong'}">
          ${quizState.lastCorrect ? '√ì d√°ra! Correct! ‚úì' : 'Not quite ‚Äî keep learning! ‚úó'}
        </div>
        <button class="quiz-next" onclick="nextQuiz()">Continue</button>
      ` : ''}
    </div>
  `;
}

function answerQuiz(idx, correct) {
  if (quizState.answered) return;
  quizState.answered = true;
  quizState.selectedIdx = idx;
  quizState.lastCorrect = correct;
  quizState.answers.push(correct);
  render();
}

function nextQuiz() {
  quizState.current++;
  quizState.answered = false;
  render();
}


// ‚îÄ‚îÄ‚îÄ DIALOGUE ‚îÄ‚îÄ‚îÄ
function renderDialogue() {
  const unit = CURRICULUM[currentUnit];
  const dialogue = unit.dialogues[0];
  const { stepIndex, messages, answered, done } = dialogueState;

  if (done) {
    markLessonDone(currentUnit, 'dialogue');
    app.innerHTML = `
      <div class="header">
        <button class="header-back" onclick="backToUnit()">${ICONS.back}</button>
        <div class="header-title">Conversation</div>
        <div style="width:40px"></div>
      </div>
      <div class="complete-screen fade-in">
        <div class="complete-emoji">üí¨</div>
        <h2>Conversation Complete!</h2>
        <p>You practiced talking with grandma!</p>
        <div class="vocab-nav">
          <button class="vocab-nav-btn primary" onclick="backToUnit()">Continue</button>
        </div>
      </div>
    `;
    return;
  }

  const currentStep = dialogue.steps[stepIndex];

  app.innerHTML = `
    <div class="header">
      <button class="header-back" onclick="backToUnit()">${ICONS.back}</button>
      <div class="header-title">Conversation</div>
      <div style="width:40px"></div>
    </div>
    <div class="dialogue-view fade-in">
      <div class="dialogue-scene">
        <div class="dialogue-scene-label">Scene</div>
        <p>${dialogue.scene}</p>
      </div>

      <div class="dialogue-messages">
        ${messages.map(m => `
          <div class="dialogue-msg ${m.speaker}">
            <div class="msg-speaker">${m.speaker === 'grandma' ? 'üëµ Grandma' : 'üôã You'}</div>
            <div>${m.yoruba}</div>
            <div class="msg-translation">${m.english}</div>
          </div>
        `).join('')}

        ${currentStep && currentStep.speaker === 'grandma' && !messages.find(m => m.yoruba === currentStep.yoruba) ? `
          <div class="dialogue-msg grandma">
            <div class="msg-speaker">üëµ Grandma</div>
            <div>${currentStep.yoruba}</div>
            <div class="msg-translation">${currentStep.english}</div>
            <button class="speak-btn" style="margin:8px auto 0;width:40px;height:40px;" onclick="speak('${currentStep.yoruba.replace(/'/g, "\\'")}')">
              ${ICONS.speaker}
            </button>
          </div>
        ` : ''}
      </div>

      ${currentStep && currentStep.speaker === 'you' && !answered ? `
        <div class="dialogue-choices">
          <label>${currentStep.prompt}</label>
          ${currentStep.choices.map((c, i) => `
            <div class="dialogue-choice" onclick="dialogueChoose(${i}, ${c.correct})">
              <div class="choice-yoruba">${c.yoruba}</div>
              <div class="choice-english">${c.english}</div>
            </div>
          `).join('')}
        </div>
      ` : ''}

      ${answered ? `
        <button class="quiz-next" onclick="dialogueNext()">Continue</button>
      ` : ''}
    </div>
  `;

  // Auto-advance for grandma messages
  if (currentStep && currentStep.speaker === 'grandma' && !messages.find(m => m.yoruba === currentStep.yoruba)) {
    setTimeout(() => {
      dialogueState.messages.push({
        speaker: 'grandma',
        yoruba: currentStep.yoruba,
        english: currentStep.english
      });
      dialogueState.stepIndex++;
      render();
    }, 800);
  }
}

function dialogueChoose(idx, correct) {
  if (dialogueState.answered) return;
  const unit = CURRICULUM[currentUnit];
  const dialogue = unit.dialogues[0];
  const step = dialogue.steps[dialogueState.stepIndex];
  const choice = step.choices[idx];

  dialogueState.messages.push({
    speaker: 'you',
    yoruba: choice.yoruba,
    english: choice.english
  });
  dialogueState.stepIndex++;
  dialogueState.answered = true;

  // Highlight correct/wrong
  const choiceEls = document.querySelectorAll('.dialogue-choice');
  step.choices.forEach((c, i) => {
    if (c.correct) choiceEls[i]?.classList.add('correct');
    else if (i === idx && !correct) choiceEls[i]?.classList.add('wrong');
  });

  setTimeout(() => render(), 300);
}

function dialogueNext() {
  const unit = CURRICULUM[currentUnit];
  const dialogue = unit.dialogues[0];
  dialogueState.answered = false;

  if (dialogueState.stepIndex >= dialogue.steps.length) {
    dialogueState.done = true;
  }
  render();
}


// ‚îÄ‚îÄ‚îÄ CULTURE ‚îÄ‚îÄ‚îÄ
function renderCulture() {
  const unit = CURRICULUM[currentUnit];
  const culture = unit.culture;

  app.innerHTML = `
    <div class="header">
      <button class="header-back" onclick="backToUnit()">${ICONS.back}</button>
      <div class="header-title">Culture Note</div>
      <div style="width:40px"></div>
    </div>
    <div class="culture-view fade-in">
      <div class="culture-card">
        <h3>${culture.title}</h3>
        ${culture.paragraphs.map(p => `<p>${p}</p>`).join('')}
        <div class="culture-highlight">
          <p><strong>üí° ${culture.highlight}</strong></p>
        </div>
      </div>
      <button class="vocab-nav-btn primary" style="width:100%;padding:16px;" onclick="finishCulture()">I've Read This ‚úì</button>
    </div>
  `;
}

function finishCulture() {
  markLessonDone(currentUnit, 'culture');
  currentView = 'complete';
  render();
}


// ‚îÄ‚îÄ‚îÄ COMPLETION ‚îÄ‚îÄ‚îÄ
function renderComplete() {
  const unit = CURRICULUM[currentUnit];
  const lessonTypes = ['vocab','flashcards','quiz','dialogue','culture'];
  const done = lessonTypes.filter(t => isLessonDone(currentUnit, t)).length;

  app.innerHTML = `
    <div class="header">
      <div style="width:40px"></div>
      <div class="header-title">Lesson Complete</div>
      <div style="width:40px"></div>
    </div>
    <div class="complete-screen fade-in">
      <div class="complete-emoji">üéä</div>
      <h2>√ì d√°ra p√∫p·ªçÃÄ!</h2>
      <p>Great work! You're making progress in "${unit.title}"</p>
      <div class="complete-stats">
        <div class="complete-stat">
          <div class="complete-stat-num">${done}/5</div>
          <div class="complete-stat-label">Lessons Done</div>
        </div>
        <div class="complete-stat">
          <div class="complete-stat-num">${getTotalWords()}</div>
          <div class="complete-stat-label">Words Learned</div>
        </div>
      </div>
      <div class="vocab-nav">
        <button class="vocab-nav-btn" onclick="goHome()">Home</button>
        <button class="vocab-nav-btn primary" onclick="backToUnit()">Continue Unit</button>
      </div>
    </div>
  `;
}


// ‚îÄ‚îÄ‚îÄ REVIEW MODE ‚îÄ‚îÄ‚îÄ
function startReview() {
  // Collect all words from completed units
  const allWords = [];
  CURRICULUM.forEach((unit, i) => {
    if (isLessonDone(i, 'vocab')) {
      allWords.push(...unit.vocab);
    }
  });

  if (allWords.length === 0) {
    alert('Complete some vocabulary lessons first!');
    return;
  }

  // Shuffle
  for (let i = allWords.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [allWords[i], allWords[j]] = [allWords[j], allWords[i]];
  }

  // Use the first unit's slot temporarily with all words
  currentUnit = 0;
  currentView = 'flashcards';
  vocabIndex = 0;
  flashcardFlipped = false;

  // Temporarily override the curriculum for review
  window._reviewWords = allWords;
  window._reviewMode = true;

  renderReviewFlashcards();
}

function renderReviewFlashcards() {
  const words = window._reviewWords;
  if (!words || vocabIndex >= words.length) {
    window._reviewMode = false;
    window._reviewWords = null;
    currentView = 'home';
    render();
    return;
  }

  const word = words[vocabIndex];

  app.innerHTML = `
    <div class="header">
      <button class="header-back" onclick="exitReview()">${ICONS.back}</button>
      <div class="header-title">Review</div>
      <div style="width:40px"></div>
    </div>
    <div class="vocab-view fade-in">
      <div class="vocab-counter">${vocabIndex + 1} of ${words.length}</div>

      <div class="flashcard-area">
        <div class="flashcard ${flashcardFlipped ? 'flipped' : ''}" onclick="flipReviewCard()">
          <div class="flashcard-front">
            <div class="vocab-yoruba">${word.yoruba}</div>
            <div class="vocab-phonetic">/${word.phonetic}/</div>
            <button class="speak-btn" onclick="event.stopPropagation(); speak('${word.yoruba.replace(/'/g, "\\'")}')">
              ${ICONS.speaker}
            </button>
            <div class="flashcard-tap">Tap to reveal</div>
          </div>
          <div class="flashcard-back">
            <div class="vocab-english" style="font-size: 24px;">${word.english}</div>
            <div class="vocab-context" style="margin-top: 12px;">${word.context}</div>
            <div class="tone-display" style="margin-top: 16px;">
              ${word.tones.map(t => `
                <div class="tone-syllable">
                  <div class="tone-bar ${t.t}"></div>
                  <div class="tone-label">${t.s}</div>
                </div>
              `).join('')}
            </div>
          </div>
        </div>
      </div>

      ${flashcardFlipped ? `
        <div class="flashcard-btns">
          <button class="flash-btn again" onclick="reviewRate('again')">Again</button>
          <button class="flash-btn hard" onclick="reviewRate('hard')">Hard</button>
          <button class="flash-btn good" onclick="reviewRate('good')">Good</button>
        </div>
      ` : ''}
    </div>
  `;
}

function flipReviewCard() { flashcardFlipped = true; renderReviewFlashcards(); }

function reviewRate(r) {
  flashcardFlipped = false;
  vocabIndex++;
  renderReviewFlashcards();
}

function exitReview() {
  window._reviewMode = false;
  window._reviewWords = null;
  goHome();
}


// ‚îÄ‚îÄ‚îÄ NAVIGATION ‚îÄ‚îÄ‚îÄ
function goHome() { currentView = 'home'; render(); }
function backToUnit() { currentView = 'unit'; render(); }


// Override render for review mode
const originalRender = render;
render = function() {
  if (window._reviewMode && currentView === 'flashcards') {
    renderReviewFlashcards();
    return;
  }
  originalRender();
};

// ‚îÄ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ
render();
</script>
</body>
</html>
